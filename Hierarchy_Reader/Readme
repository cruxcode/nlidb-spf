All functions written here. Can be separated later.
